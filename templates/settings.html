{% extends "base.html" %}

{% block title %}Account Settings{% endblock %}

{% block content %}
<div class="form-container" style="max-width: 600px; margin: 50px auto; padding: 30px; background: white; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">

    {# New back button added here based on your last request #}
    <a href="{{ url_for('community_dashboard') }}" class="back-to-community-btn" style="position: absolute; top: 25px; left: 30px; text-decoration: none; color: #6a5acd; font-weight: 600;">
        &larr; Back to Community
    </a>

    <h2 style="text-align: center; color: #5d5dff; margin-bottom: 30px; padding-top: 10px;">User Settings</h2>

    <div style="text-align: center; margin-bottom: 25px;">
        {# Corrected path assumption for user avatar #}
        <img src="{{ user.avatar }}"
             alt="{{ user.username }} avatar"
             style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid #5d5dff;">
        <p style="margin-top: 10px; font-weight: bold;">Current User: {{ user.username }}</p>
    </div>

    <form method="POST" action="{{ url_for('profile_settings') }}">
        {{ profile_form.hidden_tag() }}

        <div class="form-group mb-3">
            <label for="username" class="form-label">Username</label>
            {{ profile_form.username(class="form-control", style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;") }}
            {% for error in profile_form.username.errors %}
                <span class="text-danger" style="color: red; font-size: 0.9em;">{{ error }}</span>
            {% endfor %}
        </div>

        <div class="form-group mb-4">
            <label for="avatar" class="form-label">Profile Picture</label>
            {{ profile_form.avatar(class="form-control", style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;") }}
            {% for error in profile_form.avatar.errors %}
                <span class="text-danger" style="color: red; font-size: 0.9em;">{{ error }}</span>
            {% endfor %}
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 30px;">
            {# This Logout button will be large due to the flex layout and lack of custom CSS #}
            <a href="{{ url_for('logout') }}" class="btn btn-secondary" style="flex-grow: 1; margin-right: 15px; background-color: #f44336; border: none; color: white; padding: 10px 20px; text-align: center; border-radius: 5px; text-decoration: none;">Logout</a>

            {{ profile_form.submit(class="btn btn-primary", style="flex-grow: 1; background-color: #5d5dff; border: none; padding: 10px 20px; border-radius: 5px;") }}
        </div>
    </form>

    {# The password change form is REMOVED from this version #}

</div>
{% endblock %}